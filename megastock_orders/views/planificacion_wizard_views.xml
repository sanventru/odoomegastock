<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Vista de formulario para el wizard de planificación -->
    <record id="view_planificacion_wizard_form" model="ir.ui.view">
        <field name="name">megastock.planificacion.wizard.form</field>
        <field name="model">megastock.planificacion.wizard</field>
        <field name="arch" type="xml">
            <form string="Planificar Órdenes con Parámetros">
                <group>
                    <group>
                        <field name="test_principal" placeholder="Ej: 200"/>
                        <p class="text-muted">
                            Test resistencia papel
                        </p>
                    </group>
                    <group>
                        <field name="bobinas_seleccionadas" widget="many2many_tags"/>
                        <p class="text-muted">
                            Seleccione las bobinas (anchos) a utilizar en la planificación
                        </p>
                    </group>
                </group>
                <group>
                    <group>
                        <field name="porcentaje_sobrante" placeholder="Ej: 15"/>
                        <p class="text-muted">
                            Porcentaje de sobrante permitido
                        </p>
                    </group>
                    <group>
                        <field name="margen" placeholder="Ej: 30"/>
                        <p class="text-muted">
                            Margen de seguridad en milímetros (por defecto: 30mm)
                        </p>
                    </group>
                </group>
                <group>
                    <group>
                        <field name="limite_faltante" placeholder="Ej: 500"/>
                        <p class="text-muted">
                            Faltantes mayores o iguales a este valor serán replanificados (por defecto: 500)
                        </p>
                    </group>
                    <group/>
                </group>
                <div class="alert alert-info mt16" role="alert">
                    <strong>¿Cómo funciona?</strong>
                    <ul>
                        <li>
                            <strong>Test Principal:</strong> Define la receta de papel que se utilizará para la producción.</li>
                        <li>
                            <strong>Bobinas a Utilizar:</strong> Seleccione las bobinas (anchos) que desea considerar.
                            <ul>
                                <li>Si selecciona <strong>1 bobina</strong>: Todos los grupos usarán esa bobina.</li>
                                <li>Si selecciona <strong>2 o más bobinas</strong>: Cada grupo elegirá la mejor de las seleccionadas para minimizar su desperdicio.</li>
                            </ul>
                        </li>
                    </ul>
                    <p class="mb-0">
                        <em>Nota: El algoritmo utiliza automáticamente cavidad límite = 4 para optimizar las combinaciones.</em>
                    </p>
                </div>
                <footer>
                    <button string="Planificar" name="action_planificar" type="object" class="btn-primary"/>
                    <button string="Cancelar" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Acción para abrir el wizard -->
    <record id="action_planificacion_wizard" model="ir.actions.act_window">
        <field name="name">Planificar Órdenes</field>
        <field name="res_model">megastock.planificacion.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="binding_model_id" ref="model_megastock_production_order"/>
        <field name="binding_view_types">list</field>
    </record>
</odoo>
