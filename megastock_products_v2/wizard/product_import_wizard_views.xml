<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        
        <!-- Vista del wizard de importación -->
        <record id="product_import_wizard_form" model="ir.ui.view">
            <field name="name">product.import.wizard.form</field>
            <field name="model">product.import.wizard</field>
            <field name="arch" type="xml">
                <form string="Importar Productos desde Excel">
                    <header>
                        <button name="action_download_template" string="Descargar Plantilla" type="object" class="oe_highlight" icon="fa-download" 
                                attrs="{'invisible': [('state', '!=', 'draft')]}"/>
                        <button name="action_import_products" string="Importar Productos" type="object" class="oe_highlight" icon="fa-upload"
                                attrs="{'invisible': [('state', '!=', 'draft')]}"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,done"/>
                    </header>
                    
                    <sheet>
                        <div class="oe_title">
                            <h1>
                                <field name="name" readonly="1"/>
                            </h1>
                        </div>
                        
                        <group attrs="{'invisible': [('state', '!=', 'draft')]}">
                            <group string="Archivo Excel">
                                <field name="excel_file" filename="filename" attrs="{'required': [('state', '=', 'draft')]}"/>
                                <field name="filename" invisible="1"/>
                            </group>
                            
                            <group string="Opciones de Importación">
                                <field name="import_mode"/>
                                <field name="update_existing"/>
                                <field name="validate_data"/>
                            </group>
                        </group>
                        
                        <group attrs="{'invisible': [('state', 'in', ['draft'])]}">
                            <group string="Resultados de la Importación">
                                <field name="results" widget="text" readonly="1" nolabel="1"/>
                            </group>
                        </group>
                        
                        <div class="alert alert-info" role="alert" attrs="{'invisible': [('state', '!=', 'draft')]}">
                            <strong>Instrucciones:</strong>
                            <ol>
                                <li><strong>Descargar Plantilla:</strong> Haga clic en "Descargar Plantilla" para obtener el archivo Excel con el formato correcto.</li>
                                <li><strong>Completar Datos:</strong> Complete los datos de productos en el archivo Excel descargado.</li>
                                <li><strong>Subir Archivo:</strong> Seleccione el archivo Excel completado en el campo "Archivo Excel".</li>
                                <li><strong>Configurar Opciones:</strong> Seleccione el modo de importación y otras opciones según sus necesidades.</li>
                                <li><strong>Importar:</strong> Haga clic en "Importar Productos" para procesar el archivo.</li>
                            </ol>
                        </div>
                        
                        <div class="alert alert-warning" role="alert" attrs="{'invisible': [('state', '!=', 'draft')]}">
                            <strong>Campos por Categoría MEGASTOCK:</strong>
                            <ul>
                                <li><strong>CAJAS:</strong> Dimensiones (largo, ancho, alto, ceja), flauta, test, material, tipo de caja</li>
                                <li><strong>LÁMINAS:</strong> Dimensiones (largo, ancho), flauta, test, material, colores de impresión</li>
                                <li><strong>PAPEL PERIÓDICO:</strong> Dimensiones, gramaje, colores de impresión</li>
                                <li><strong>PLANCHAS:</strong> Dimensiones, flauta, test, material</li>
                                <li><strong>SEPARADORES:</strong> Dimensiones, flauta, material</li>
                                <li><strong>MATERIAS PRIMAS:</strong> Campos básicos, material, KL</li>
                            </ul>
                        </div>
                    </sheet>
                </form>
            </field>
        </record>
        
        <!-- Acción del wizard -->
        <record id="action_product_import_wizard" model="ir.actions.act_window">
            <field name="name">Importar Productos desde Excel</field>
            <field name="res_model">product.import.wizard</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
            <field name="view_id" ref="product_import_wizard_form"/>
        </record>
        
        <!-- Crear submenú Productos bajo Fabricación -->
        <menuitem 
            id="menu_mrp_productos_megastock"
            name="Productos"
            parent="mrp.menu_mrp_root"
            sequence="10"/>
        
        <!-- Menú Importar Excel bajo Productos -->
        <menuitem 
            id="menu_product_import_wizard"
            name="Importar desde Excel"
            parent="menu_mrp_productos_megastock"
            action="action_product_import_wizard"
            sequence="5"/>
            
        <!-- Acceso directo también en el menú BOM si existe -->
        <menuitem 
            id="menu_product_import_wizard_bom"
            name="Importar Productos"
            parent="mrp.menu_mrp_bom"
            action="action_product_import_wizard"
            sequence="1"
            groups="mrp.group_mrp_user"/>
            
    </data>
</odoo>