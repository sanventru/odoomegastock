<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Reporte de Etiquetas para Órdenes de Trabajo -->
    <report 
        id="action_workorder_label_report"
        string="Etiqueta de Orden de Trabajo"
        model="mrp.workorder" 
        report_type="qweb-pdf"
        name="mrp_production_lines.workorder_label_template"
        file="mrp_production_lines.workorder_label_template"
        attachment_use="False"
        paperformat="mrp_production_lines.paperformat_label"/>

    <!-- Formato de papel para etiquetas -->
    <record id="paperformat_label" model="report.paperformat">
        <field name="name">Etiqueta 100x80mm</field>
        <field name="default" eval="False"/>
        <field name="format">custom</field>
        <field name="page_height">80</field>
        <field name="page_width">100</field>
        <field name="orientation">Portrait</field>
        <field name="margin_top">5</field>
        <field name="margin_bottom">5</field>
        <field name="margin_left">5</field>
        <field name="margin_right">5</field>
        <field name="header_line" eval="False"/>
        <field name="header_spacing">0</field>
        <field name="dpi">96</field>
    </record>

    <!-- Template principal de etiquetas -->
    <template id="workorder_label_template">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="workorder">
                
                <!-- Etiqueta para Línea de Papel Periódico -->
                <t t-if="workorder.production_line == 'papel_periodico'">
                    <t t-call="mrp_production_lines.label_papel_periodico"/>
                </t>
                
                <!-- Etiqueta para Línea de Cajas -->
                <t t-elif="workorder.production_line == 'cajas'">
                    <t t-call="mrp_production_lines.label_cajas"/>
                </t>
                
                <!-- Etiqueta para Línea de Lámina Micro -->
                <t t-elif="workorder.production_line == 'lamina_micro'">
                    <t t-call="mrp_production_lines.label_lamina_micro"/>
                </t>
                
                <!-- Etiqueta genérica para casos no definidos -->
                <t t-else="">
                    <t t-call="mrp_production_lines.label_generic"/>
                </t>
                
            </t>
        </t>
    </template>

    <!-- Template para Papel Periódico -->
    <template id="label_papel_periodico">
        <div class="page" style="width: 90mm; height: 70mm; border: 1px solid #000; padding: 2mm; font-family: Arial; font-size: 8pt;">
            
            <!-- Header -->
            <div style="text-align: center; font-weight: bold; font-size: 10pt; border-bottom: 1px solid #ccc; padding-bottom: 2mm; margin-bottom: 2mm;">
                PAPEL PERIÓDICO
            </div>
            
            <!-- Información Principal -->
            <table style="width: 100%; font-size: 8pt;">
                <tr>
                    <td style="width: 40%;"><strong>N° OP:</strong></td>
                    <td style="width: 60%;"><t t-esc="workorder.production_id.name"/></td>
                </tr>
                <tr>
                    <td><strong>Cliente:</strong></td>
                    <td><t t-esc="workorder.production_id.partner_id.name or 'N/A'"/></td>
                </tr>
                <tr>
                    <td><strong>Fecha:</strong></td>
                    <td><t t-esc="workorder.date_start and workorder.date_start.strftime('%d/%m/%Y %H:%M') or 'N/A'"/></td>
                </tr>
                <tr>
                    <td><strong>Pallet:</strong></td>
                    <td><t t-esc="workorder.pallet_number or 'N/A'"/></td>
                </tr>
                <tr>
                    <td><strong>Medida:</strong></td>
                    <td><t t-esc="workorder.product_id.name"/></td>
                </tr>
                <tr>
                    <td><strong>Gramaje:</strong></td>
                    <td><t t-esc="workorder.grammage"/> g/m²</td>
                </tr>
                <tr>
                    <td><strong>Cantidad:</strong></td>
                    <td><t t-esc="workorder.qty_production"/> <t t-esc="workorder.product_uom_id.name"/></td>
                </tr>
                <tr>
                    <td><strong>Operador:</strong></td>
                    <td><t t-esc="workorder.operator_name or 'N/A'"/></td>
                </tr>
            </table>
            
            <!-- QR Code o Código de Barras (si está disponible) -->
            <div style="text-align: center; margin-top: 3mm;">
                <t t-if="workorder.pallet_number">
                    <img t-att-src="'/report/barcode/?type=%s&amp;value=%s&amp;width=%s&amp;height=%s' % ('Code128', workorder.pallet_number, 200, 50)" style="width: 60mm; height: 8mm;"/>
                </t>
            </div>
            
        </div>
    </template>

    <!-- Template para Cajas -->
    <template id="label_cajas">
        <div class="page" style="width: 90mm; height: 70mm; border: 1px solid #000; padding: 2mm; font-family: Arial; font-size: 8pt;">
            
            <!-- Header -->
            <div style="text-align: center; font-weight: bold; font-size: 10pt; border-bottom: 1px solid #ccc; padding-bottom: 2mm; margin-bottom: 2mm; background-color: #e8f4fd;">
                CAJAS &amp; PLANCHAS
            </div>
            
            <!-- Información Principal -->
            <table style="width: 100%; font-size: 8pt;">
                <tr>
                    <td style="width: 40%;"><strong>N° OP:</strong></td>
                    <td style="width: 60%;"><t t-esc="workorder.production_id.name"/></td>
                </tr>
                <tr>
                    <td><strong>Cliente:</strong></td>
                    <td><t t-esc="workorder.production_id.partner_id.name or 'N/A'"/></td>
                </tr>
                <tr>
                    <td><strong>Operador:</strong></td>
                    <td><t t-esc="workorder.operator_name or 'N/A'"/></td>
                </tr>
                <tr>
                    <td><strong>Turno:</strong></td>
                    <td><t t-esc="dict(workorder._fields['shift'].selection).get(workorder.shift, 'N/A')"/></td>
                </tr>
                <tr>
                    <td><strong>Material:</strong></td>
                    <td><t t-esc="workorder.material_type or 'N/A'"/></td>
                </tr>
                <tr>
                    <td><strong>Test:</strong></td>
                    <td><t t-esc="workorder.test_value or 'N/A'"/></td>
                </tr>
                <tr>
                    <td><strong>Medida:</strong></td>
                    <td><t t-esc="workorder.product_id.name"/></td>
                </tr>
                <tr>
                    <td><strong>Cantidad:</strong></td>
                    <td><t t-esc="workorder.qty_production"/> <t t-esc="workorder.product_uom_id.name"/></td>
                </tr>
                <tr>
                    <td><strong>Unidades:</strong></td>
                    <td><t t-esc="workorder.units_per_package or 'N/A'"/></td>
                </tr>
                <tr>
                    <td><strong>Bultos:</strong></td>
                    <td><t t-esc="workorder.total_packages or 'N/A'"/></td>
                </tr>
            </table>
            
            <!-- Logo del cliente si está marcado -->
            <t t-if="workorder.customer_logo">
                <div style="text-align: center; margin-top: 2mm; font-size: 6pt; color: #666;">
                    *** INCLUIR LOGO CLIENTE ***
                </div>
            </t>
            
        </div>
    </template>

    <!-- Template para Lámina Micro -->
    <template id="label_lamina_micro">
        <div class="page" style="width: 90mm; height: 70mm; border: 1px solid #000; padding: 2mm; font-family: Arial; font-size: 8pt;">
            
            <!-- Header -->
            <div style="text-align: center; font-weight: bold; font-size: 10pt; border-bottom: 1px solid #ccc; padding-bottom: 2mm; margin-bottom: 2mm; background-color: #fff2e8;">
                LÁMINA MICROCORRUGADA
            </div>
            
            <!-- Información Principal -->
            <table style="width: 100%; font-size: 8pt;">
                <tr>
                    <td style="width: 40%;"><strong>N° OP:</strong></td>
                    <td style="width: 60%;"><t t-esc="workorder.production_id.name"/></td>
                </tr>
                <tr>
                    <td><strong>Cliente:</strong></td>
                    <td><t t-esc="workorder.production_id.partner_id.name or 'N/A'"/></td>
                </tr>
                <tr>
                    <td><strong>Operador:</strong></td>
                    <td><t t-esc="workorder.operator_name or 'N/A'"/></td>
                </tr>
                <tr>
                    <td><strong>Peso:</strong></td>
                    <td><t t-esc="workorder.weight or 'N/A'"/> kg</td>
                </tr>
                <tr>
                    <td><strong>Gramaje:</strong></td>
                    <td><t t-esc="workorder.grammage or 'N/A'"/> g/m²</td>
                </tr>
                <tr>
                    <td><strong>Medida:</strong></td>
                    <td><t t-esc="workorder.product_id.name"/></td>
                </tr>
                <tr>
                    <td><strong>Cantidad:</strong></td>
                    <td><t t-esc="workorder.qty_production"/> <t t-esc="workorder.product_uom_id.name"/></td>
                </tr>
                <tr>
                    <td><strong>Cant. Paquete:</strong></td>
                    <td><t t-esc="workorder.units_per_package or 'N/A'"/></td>
                </tr>
            </table>
            
            <!-- Logo del cliente si está marcado -->
            <t t-if="workorder.customer_logo">
                <div style="text-align: center; margin-top: 2mm; font-size: 6pt; color: #666;">
                    *** INCLUIR LOGO CLIENTE ***
                </div>
            </t>
            
            <!-- Fecha de producción -->
            <div style="text-align: center; margin-top: 2mm; font-size: 6pt; color: #333;">
                Fecha: <t t-esc="workorder.date_start and workorder.date_start.strftime('%d/%m/%Y %H:%M') or 'N/A'"/>
            </div>
            
        </div>
    </template>

    <!-- Template Genérico -->
    <template id="label_generic">
        <div class="page" style="width: 90mm; height: 70mm; border: 1px solid #000; padding: 2mm; font-family: Arial; font-size: 8pt;">
            
            <!-- Header -->
            <div style="text-align: center; font-weight: bold; font-size: 10pt; border-bottom: 1px solid #ccc; padding-bottom: 2mm; margin-bottom: 2mm;">
                ETIQUETA DE PRODUCCIÓN
            </div>
            
            <!-- Información Principal -->
            <table style="width: 100%; font-size: 8pt;">
                <tr>
                    <td style="width: 40%;"><strong>N° OP:</strong></td>
                    <td style="width: 60%;"><t t-esc="workorder.production_id.name"/></td>
                </tr>
                <tr>
                    <td><strong>Producto:</strong></td>
                    <td><t t-esc="workorder.product_id.name"/></td>
                </tr>
                <tr>
                    <td><strong>Centro:</strong></td>
                    <td><t t-esc="workorder.workcenter_id.name"/></td>
                </tr>
                <tr>
                    <td><strong>Cantidad:</strong></td>
                    <td><t t-esc="workorder.qty_production"/> <t t-esc="workorder.product_uom_id.name"/></td>
                </tr>
                <tr>
                    <td><strong>Fecha:</strong></td>
                    <td><t t-esc="workorder.date_start and workorder.date_start.strftime('%d/%m/%Y') or 'N/A'"/></td>
                </tr>
                <tr>
                    <td><strong>Operador:</strong></td>
                    <td><t t-esc="workorder.operator_name or 'N/A'"/></td>
                </tr>
            </table>
            
            <!-- Información adicional -->
            <div style="text-align: center; margin-top: 3mm; font-size: 6pt; color: #666;">
                <t t-if="workorder.pallet_number">
                    Pallet: <t t-esc="workorder.pallet_number"/>
                </t>
            </div>
            
        </div>
    </template>

</odoo>